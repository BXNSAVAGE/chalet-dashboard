<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chalet Manager ‚Äî Vollst√§ndig</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    :root {
      --bg:#f7f7f9; --glass:#ffffffcc; --text:#0b0c0f; --muted:#6b7280;
      --accent:#0a84ff; --good:#16a34a; --pending:#ea580c; --bad:#ef4444;
      --radius:16px; --pad:14px; --shadow:0 8px 24px rgba(0,0,0,.06);
    }

    * { box-sizing:border-box; margin:0; padding:0; }
    html, body { 
      height:100%; 
      font:16px/1.45 -apple-system, BlinkMacSystemFont, "SF Pro Text","SF Pro Display",Helvetica,Arial,sans-serif; 
      -webkit-font-smoothing:antialiased; 
      background:linear-gradient(180deg,#f9fafb 0%,#eef1f6 100%); 
      color:var(--text); 
    }

    header {
      position:sticky; top:0; z-index:10;
      display:flex; align-items:center; gap:16px; padding:12px 16px;
      backdrop-filter:saturate(180%) blur(18px); 
      background:#ffffffb3; 
      border-bottom:1px solid #eceef2;
    }
    .brand { font-weight:700; font-size:18px; }
    .pill { 
      padding:8px 12px; 
      border-radius:999px; 
      background:#eef2ff; 
      color:#334155; 
      font-weight:600; 
      font-size:13px; 
    }

    .nav-tabs {
      display:flex; 
      gap:4px; 
      margin-left:auto;
    }
    .nav-tab {
      padding:8px 16px; 
      border-radius:8px; 
      background:transparent;
      color:#64748b; 
      font-weight:600; 
      cursor:pointer; 
      border:none;
      transition: all 0.2s; 
      font-size:14px;
    }
    .nav-tab:hover { background:#f1f5f9; }
    .nav-tab.active { background:var(--accent); color:#fff; }

    main.grid {
      display:grid; 
      gap:16px; 
      padding:16px; 
      max-width:1800px; 
      margin:0 auto;
      grid-template-columns:280px 1fr 380px;
    }
    @media(max-width:1400px){ 
      main.grid { grid-template-columns:1fr 380px; } 
      .sidebar-left { display:none !important; } 
    }
    @media(max-width:900px){ 
      main.grid { grid-template-columns:1fr; } 
    }

    main.single { 
      max-width:1400px; 
      margin:0 auto; 
      padding:16px; 
    }

    .card {
      background:var(--glass); 
      border-radius:var(--radius); 
      box-shadow:var(--shadow);
      padding:var(--pad); 
      backdrop-filter:saturate(160%) blur(14px);
    }
    .card h3 { margin:0 0 12px; font-size:18px; }

    .btn {
      display:inline-flex; 
      align-items:center; 
      gap:8px; 
      padding:10px 14px;
      border:0; 
      border-radius:12px; 
      background:linear-gradient(#0a84ff,#0066d6);
      color:#fff; 
      font-weight:600; 
      box-shadow:var(--shadow); 
      cursor:pointer; 
      transition: all 0.2s;
      font-size:14px;
    }
    .btn:hover { 
      transform: translateY(-1px); 
      box-shadow: 0 12px 28px rgba(0,0,0,.1); 
    }
    .btn.secondary { background:#eef1f6; color:#0b0c0f; }
    .btn.ghost { 
      background:transparent; 
      border:1px solid #e5e7eb; 
      color:#0b0c0f; 
      box-shadow: none; 
    }
    .btn.danger { background:linear-gradient(#ef4444,#dc2626); color:#fff; }
    .btn.success { background:linear-gradient(#16a34a,#15803d); }
    .btn.small { padding:6px 10px; font-size:13px; }

    .stat {
      display:flex; 
      align-items:center; 
      justify-content:space-between; 
      padding:12px;
      background:#fff; 
      border-radius:12px; 
      border:1px solid #eef0f4;
    }
    .tag {
      padding:6px 10px; 
      border-radius:999px; 
      font-weight:700; 
      font-size:12px;
    }
    .tag.pending { background:#ffedd5; color:var(--pending); }
    .tag.confirm { background:#dcfce7; color:var(--good); }

    .stats-grid {
      display:grid; 
      grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
      gap:16px; 
      margin-bottom:20px;
    }
    .stat-card {
      background:#fff; 
      border:1px solid #eef0f4; 
      border-radius:12px;
      padding:16px;
    }
    .stat-label {
      color:#94a3b8; 
      font-size:12px; 
      margin-bottom:6px;
    }
    .stat-value {
      font-size:24px; 
      font-weight:700;
    }

    .calendar { padding:0; overflow:hidden; }
    .cal-head { 
      display:flex; 
      align-items:center; 
      justify-content:space-between; 
      padding:12px 12px 8px; 
    }
    .cal-title { font-weight:700; font-size:18px; }
    .legend { 
      display:flex; 
      gap:10px; 
      align-items:center; 
      color:var(--muted); 
      font-size:12px; 
    }
    .dot { 
      width:10px; 
      height:10px; 
      border-radius:50%; 
      display:inline-block; 
    }
    .dot.pending { background:var(--pending); }
    .dot.confirm { background:var(--good); }

    .cal-grid {
      display:grid; 
      grid-template-columns:repeat(7,1fr); 
      gap:10px; 
      padding:12px;
      background:transparent; 
      border-top:1px solid #eceef2;
    }
    .dow {
      text-align: center;
      font-weight: 700;
      font-size: 12px;
      color: #64748b;
      padding: 8px 0;
      border-bottom: 1px solid #eef0f4;
    }
    .cell {
      aspect-ratio:1/1; 
      background:#fff; 
      border:1px solid #eef0f4;
      border-radius:12px; 
      position:relative; 
      overflow:hidden;
    }
    .date { 
      position:absolute; 
      top:8px; 
      right:10px; 
      color:#94a3b8; 
      font-size:12px; 
      z-index:3; 
      pointer-events:none; 
    }
    .seg {
      position:absolute; 
      inset:8px; 
      border-radius:12px; 
      color:#fff;
      font-weight:800; 
      font-size:13px; 
      display:flex; 
      align-items:center; 
      justify-content:center;
      text-align:center; 
      cursor:pointer; 
      z-index:1;
    }
    .seg.pending { background:var(--pending); }
    .seg.confirm { background:var(--good); }

    .email-list {
      max-height: calc(100vh - 200px);
      overflow-y: auto;
    }
    .email-item {
      background:#fff; 
      border:1px solid #eef0f4; 
      border-radius:12px;
      padding:12px; 
      margin-bottom:10px; 
      cursor:pointer; 
      transition: all 0.2s;
    }
    .email-item:hover {
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(0,0,0,.08);
    }
    .email-item.assigned {
      border-left: 4px solid var(--good);
    }

    .folder-tree {
      background:#fff; 
      border-radius:12px; 
      border:1px solid #eef0f4;
      padding:12px; 
      margin-bottom:16px; 
      max-height:400px; 
      overflow-y:auto;
    }
    .folder {
      padding:10px 12px; 
      border-radius:8px; 
      cursor:pointer;
      display:flex; 
      align-items:center; 
      gap:8px; 
      transition: all 0.2s;
      margin-bottom:4px;
    }
    .folder:hover { background:#f8fafc; }
    .folder.active { 
      background:#eff6ff; 
      border-left:3px solid var(--accent); 
    }
    .folder-icon { font-size:18px; }
    .folder-name { font-weight:600; flex:1; }
    .folder-count { color:#94a3b8; font-size:12px; }

    .invoice-list {
      display:grid; 
      gap:12px;
    }
    .invoice-item {
      background:#fff; 
      border:1px solid #eef0f4; 
      border-radius:12px;
      padding:14px 16px; 
      cursor:pointer; 
      transition: all 0.2s;
      display:flex; 
      align-items:center; 
      gap:16px;
    }
    .invoice-item:hover {
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(0,0,0,.08);
    }
    .invoice-number {
      font-weight:700; 
      font-size:16px; 
      color:var(--accent);
      min-width:80px;
    }
    .invoice-details {
      flex:1;
    }
    .invoice-guest {
      font-weight:600; 
      margin-bottom:4px;
    }
    .invoice-date {
      color:#94a3b8; 
      font-size:13px;
    }
    .invoice-amount {
      font-weight:700; 
      font-size:18px; 
      text-align:right;
      min-width:100px;
    }
    .invoice-status {
      padding:6px 12px; 
      border-radius:999px; 
      font-size:12px; 
      font-weight:700;
    }
    .invoice-status.paid { 
      background:#dcfce7; 
      color:var(--good); 
    }
    .invoice-status.pending { 
      background:#ffedd5; 
      color:var(--pending); 
    }

    .search-input {
      flex:1; 
      padding:12px 16px; 
      border:1px solid #e5e7eb; 
      border-radius:12px;
      font-size:14px; 
      background:#fff; 
      width:100%;
    }
    .search-input:focus { 
      outline:none; 
      border-color:var(--accent); 
    }

    .page { display:none; }
    .page.active { display:block; }

    .overlay {
      position:fixed; 
      inset:0; 
      background:rgba(0,0,0,.25);
      display:none; 
      align-items:center; 
      justify-content:center; 
      padding:16px; 
      z-index:100;
    }
    .modal {
      width:min(900px,96vw); 
      max-height:90vh;
      background:#fff; 
      border-radius:20px;
      box-shadow:0 24px 60px rgba(0,0,0,.18); 
      overflow:hidden;
      display:flex; 
      flex-direction:column;
    }
    .modal-head {
      display:flex; 
      align-items:center; 
      justify-content:space-between;
      padding:16px 18px; 
      border-bottom:1px solid #eef0f4;
    }
    .modal-body {
      padding:20px; 
      overflow-y:auto; 
      flex:1;
    }
    .modal-actions {
      display:flex; 
      gap:10px; 
      padding:16px 18px;
      border-top:1px solid #eef0f4; 
      justify-content:space-between;
    }

    .form-grid {
      display:grid; 
      grid-template-columns:1fr 1fr; 
      gap:16px;
    }
    .form-field {
      display:flex; 
      flex-direction:column; 
      gap:6px;
    }
    .form-field.full {
      grid-column:1 / span 2;
    }
    .form-field label {
      font-size:13px; 
      font-weight:600; 
      color:#64748b;
    }
    .form-field input, .form-field textarea, .form-field select {
      padding:10px 12px; 
      border:1px solid #e5e7eb; 
      border-radius:8px;
      font-size:14px; 
      font-family:inherit; 
      background:#fff;
    }
    .form-field input:focus, .form-field textarea:focus, .form-field select:focus {
      outline:none; 
      border-color:var(--accent);
    }
    .form-field textarea {
      resize:vertical; 
      min-height:80px;
    }

    .invoice-items {
      background:#f8fafc; 
      border-radius:12px; 
      padding:16px; 
      margin:16px 0;
    }
    .invoice-items h4 {
      margin-bottom:12px; 
      font-size:14px;
    }
    .item-row {
      display:grid; 
      grid-template-columns:2fr 1fr 1fr 1fr auto; 
      gap:8px;
      align-items:center; 
      margin-bottom:8px;
    }
    .item-row input {
      padding:8px 10px; 
      border:1px solid #e5e7eb; 
      border-radius:6px;
      font-size:13px;
    }
    .remove-item {
      background:#fee2e2; 
      color:#dc2626; 
      border:none;
      padding:6px 10px; 
      border-radius:6px; 
      cursor:pointer; 
      font-weight:600;
    }

    .invoice-totals {
      background:#f8fafc; 
      border-radius:12px; 
      padding:16px; 
      margin-top:16px;
    }
    .total-row {
      display:flex; 
      justify-content:space-between; 
      padding:8px 0;
      font-size:14px;
    }
    .total-row.grand {
      border-top:2px solid #e5e7eb; 
      margin-top:8px; 
      padding-top:12px;
      font-weight:700; 
      font-size:16px;
    }

    .invoice-preview {
      background:#fff; 
      border:1px solid #e5e7eb; 
      border-radius:12px;
      padding:40px; 
      font-size:13px; 
      line-height:1.6;
      box-shadow: 0 4px 12px rgba(0,0,0,.06);
    }
    .invoice-header {
      display:flex; 
      justify-content:space-between; 
      margin-bottom:30px;
    }
    .invoice-logo {
      font-size:24px; 
      font-weight:700; 
      color:var(--accent);
    }
    .invoice-info {
      text-align:right; 
      color:#64748b;
    }
    .invoice-addresses {
      display:grid; 
      grid-template-columns:1fr 1fr; 
      gap:40px;
      margin:30px 0;
    }
    .address-block h4 {
      font-size:12px; 
      color:#94a3b8; 
      margin-bottom:8px;
      text-transform:uppercase; 
      letter-spacing:0.5px;
    }
    .invoice-table {
      width:100%; 
      border-collapse:collapse; 
      margin:30px 0;
    }
    .invoice-table th {
      background:#f8fafc; 
      padding:12px; 
      text-align:left;
      font-size:12px; 
      color:#64748b; 
      border-bottom:2px solid #e5e7eb;
    }
    .invoice-table td {
      padding:12px; 
      border-bottom:1px solid #eef0f4;
    }

    .tabs {
      display:flex;
      gap:8px;
      border-bottom:2px solid #eef0f4;
      margin-bottom:16px;
      padding:0 18px;
    }
    .tab {
      padding:10px 16px;
      border:none;
      background:transparent;
      color:#64748b;
      font-weight:600;
      cursor:pointer;
      position:relative;
      transition: all 0.2s;
    }
    .tab:hover {
      color:var(--text);
    }
    .tab.active {
      color:var(--accent);
    }
    .tab.active::after {
      content:'';
      position:absolute;
      bottom:-2px;
      left:0;
      right:0;
      height:2px;
      background:var(--accent);
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">üèîÔ∏è Chalet Manager</div>
    <span class="pill">Vollst√§ndiges Dashboard</span>
    <div class="nav-tabs">
      <button class="nav-tab active" data-page="calendar">üìÖ Kalender</button>
      <button class="nav-tab" data-page="invoices">üßæ Rechnungen</button>
    </div>
    <div style="margin-left:auto;display:flex;gap:8px">
      <button class="btn secondary" id="syncEmailsBtn">üìß E-Mails</button>
      <button class="btn" id="addBookingBtn">Buchung hinzuf√ºgen</button>
    </div>
  </header>
  
  <!-- Calendar Page -->
  <main class="grid page active" id="calendarPage">
    <aside class="sidebar-left">
      <div class="card">
        <h3>N√§chster Termin</h3>
        <div class="stat" style="margin-top:8px" id="nextAppointment">
          <div>
            <div style="color:var(--muted);font-size:14px">Wird geladen...</div>
          </div>
          <span class="tag confirm">‚Äî</span>
        </div>
      </div>
    </aside>
    
    <section class="card calendar">
      <div class="cal-head">
        <div class="cal-title" id="calTitle">Kalender</div>
        <div class="legend" style="margin-left:auto;margin-right:auto">
          <span class="dot pending"></span> Ausstehend
          <span class="dot confirm" style="margin-left:12px"></span> Best√§tigt
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn secondary" id="prevBtn">‚Äπ</button>
          <button class="btn secondary" id="todayBtn">Heute</button>
          <button class="btn secondary" id="nextBtn">‚Ä∫</button>
        </div>
      </div>
      <div class="cal-grid" id="calGrid"></div>
    </section>
    
    <section>
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <h3 style="margin:0">üì¨ E-Mail Posteingang</h3>
          <span id="emailCount" class="pill" style="font-size:12px">0</span>
        </div>
        
        <div id="emailList" class="email-list">
          <div style="text-align:center;color:var(--muted);padding:20px">
            Keine E-Mails geladen
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Invoices Page -->
  <main class="single page" id="invoicesPage">
    <div class="card">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">Gesamt Rechnungen</div>
          <div class="stat-value" id="totalInvoices">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Offen</div>
          <div class="stat-value" style="color:var(--pending)" id="pendingInvoices">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Bezahlt</div>
          <div class="stat-value" style="color:var(--good)" id="paidInvoices">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Gesamtumsatz</div>
          <div class="stat-value" id="totalRevenue">‚Ç¨0.00</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div style="display:flex;gap:12px;margin-bottom:20px">
        <input type="text" id="searchInput" class="search-input" placeholder="üîç Suche nach Rechnungsnummer, Gast, Betrag..." />
        <button class="btn secondary" id="createFolderBtn">üìÅ Neuer Ordner</button>
        <button class="btn success" id="createInvoiceBtn">‚ûï Rechnung erstellen</button>
      </div>

      <div class="folder-tree" id="folderTree"></div>

      <div class="invoice-list" id="invoiceList">
        <div style="text-align:center;color:var(--muted);padding:40px">
          Keine Rechnungen vorhanden
        </div>
      </div>
    </div>
  </main>

  <!-- Modals kommen im n√§chsten Teil -->
  
  <script src="app.js"></script>
</body>
</html>
